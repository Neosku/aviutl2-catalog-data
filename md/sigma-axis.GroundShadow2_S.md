# GroundShadow2_S スクリプト

## 概要

影を立体的に地面へ落とすアニメーション効果 / フィルタ効果．地面だけでなく壁や天井など任意角度の平面に影を落とせます．

##  パラメタの説明

### `地面位置`

影を落とす「地面」の位置を指定します．ここで指定した座標を通り，[`地面角度`](#地面角度) と [`回転`](#回転) で指定した角度の平面に影を落とします．プレビューのアンカーをドラッグすることでも調整できます．

- 緑のアンカー線を操作することで指定できます．

  - オブジェクトが「地面」に接する点にアンカーを置くことで「地面に立っている」ような表現ができます．オブジェクトから離すと「地面から浮いている」ように見えます．

- 座標は 3 次元で指定します．オブジェクトと平行で，オブジェクトの奥にある平面などに影を投射することもできます．

オブジェクトの中心からの相対座標で `{<X座標>, <Y座標>, <Z座標>}` とピクセル単位で記述します．初期値は `{0,200,0}`.

### `地面角度`

影を落とす先の「地面」の仰角を指定します．[`回転`](#回転) が `0` の場合，カメラ視点を基準として次のように決まります:

|負の値|`0`|正の値|
|:---:|:---:|:---:|
|下り坂|水平|上り坂|

単位は度数法で最小値は `-180`, 最大値は `180`, 初期値は `0`.

### `光源角度` / `光源傾斜`

光の入射角を指定します．[`回転`](#回転) が `0` の場合，`光源角度` で上下方向が，`光源傾斜` で左右方向が，カメラ視点を基準として次のように決まります:

|パラメタ|負の値|`0`|正の値|
|:---:|:---:|:---:|:---:|
|`光源角度`|上から下|手前から奥への水平方向|下から上|
|`光源傾斜`|右から左|左右にまっすぐ|左から右|

`光源角度` の単位は度数法で最小値は `-180`, 最大値は `180`, 初期値は `-45`.

`光源傾斜` は傾斜量 (角度の正接 ($\tan$ 関数) の値) の % 単位で，最小値は `-800` (約 $-82.87\degree$), 最大値は `800` (約 $82.87\degree$), 初期値は `0`.

### `回転`

影を落とす先の「地面」の回転角を指定します．回転軸は $z$ 軸方向 (手前から奥への方向) で，時計回りに正．これに連動して，[`光源角度` や `光源傾斜`](#光源角度--光源傾斜) で指定した「光源」の角度も回転します．

単位は度数法で最小値は `-720`, 最大値は `720`, 初期値は `0`.

### `カメラ位置`

立体射影を計算する際の，カメラ位置の $x, y$ 座標を指定します．プレビューのアンカーをドラッグすることでも調整できます．

- 青いアンカー線を操作することで指定できます．

  - オブジェクトに拡大率や回転などが設定されていた場合，アンカー位置を正しく取得できない場合があります．

オブジェクトの中心からの相対座標で `{<X座標>, <Y座標>}` とピクセル単位で記述します．初期値は `{0,-200}`.

### `視野幅`

立体射影を計算する際の，カメラの視野角を調整します．単位は % で，視野角の正接 ($\tan$ 関数の値) の割合で指定します．

- 大きくすると立体感が強くなり，遠くの影がさらに小さく，近くの影はさらに大きくなります．
- 小さくすると立体感が弱くなり，遠くの影と近くの影の大きさに違いが出にくくなります．
- `0` を指定すると[直投影](https://ja.wikipedia.org/wiki/%E7%9B%B4%E6%8A%95%E5%BD%B1) ([orthographic projection](https://en.wikipedia.org/wiki/Orthographic_projection)) な描画ができます．
  - この場合 [`カメラ位置`](#カメラ位置) のパラメタは影響しなくなります．

最小値は `0`, 最大値は `10000`, 初期値は `100`.

### `影色`

影の色を指定します．初期値は `000000` (黒).

### `影色強さ`

[`影色`](#影色) を適用する強さ指定します．`0` だと元オブジェクトと同じ色で影を描画します．

単位は % で最小値は `0`, 最大値は `100`, 初期値は `100`.

### `影の濃さ`

影の不透明度を指定します．

単位は % で最小値は `0`, 最大値は `100`, 初期値は `50`.

### `前景透明度`

影の元となるオブジェクトの透明度を指定します．

単位は % で最小値は `0`, 最大値は `100`, 初期値は `0`.

### `光拡散` / `境界ぼかし`

影のぼかし方を指定します．

- `光拡散` は光源の入射角のブレ量で，オブジェクトと「地面」に映る影との距離が長いほどぼかし量が大きくなります．

- `境界ぼかし` は元画像にそのままかけるぼかし量で，「地面」との距離に依存しません．

`光拡散` は拡散角度の正接 ($\tan$ 関数の値) の % 単位で，最小値は `0`, 最大値は `70` (約 $\pm 35\degree$), 初期値は `5` (約 $\pm 2.867\degree$).

`境界ぼかし` はピクセル単位で最小値は `0`, 最大値は `500`, 初期値は `4`.

### `影の範囲`

[`地面位置`](#地面位置) で指定した $x, y$ 座標 に近い部分のみを影の描画対象にします．描画対象の範囲を `地面位置` からの距離で指定，`0` を指定すると現在オブジェクト全てが描画対象になります．

ピクセル単位で指定し最小値は `0`, 最大値は `4000`, 初期値は `0`.

### `先端ぼかし`

[`影の範囲`](#影の範囲) が `0` 以外の場合にのみ有効で，描画範囲の先端部分の不透明度を距離に応じて減衰させます．

薄くなる部分の距離をピクセル単位で指定．最小値は `0`, 最大値は `2000`, 初期値は `0`.

### `影位置移動`

影の描画位置を平行移動で動かします．プレビューのアンカーをドラッグすることでも調整できます．

- 線のついていないアンカーを操作することで指定できます．

`{<X移動量>, <Y移動量>}` の書式でピクセル単位で記述します．初期値は `{0,0}` (移動なし).


### `PI`

パラメタインジェクション (parameter injection) です．各種パラメタを Lua の数式で直接指定できます．また，任意のスクリプトコードを実行する記述領域にもなります．

※引用元：[GroundShadow2_S/README.md](https://github.com/sigma-axis/aviutl2_script_GroundShadow2_S/blob/main/README.md)

## 参考

- [説明文章](https://github.com/sigma-axis/aviutl2_script_GroundShadow2_S/blob/main/README.md)
- [紹介動画](https://www.nicovideo.jp/watch/sm45275176)
- [作者のTwitter](https://x.com/sigma_axis)
- [作者のGitHub](https://github.com/sigma-axis)